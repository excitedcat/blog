<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 压力测试 · ExcitedCat</title><meta name="description" content="压力测试 - kangfenmao"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://www.ijustplay.cn/atom.xml" title="ExcitedCat"></head><body><div class="wrap"><header><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link"> Blog</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link"> Archive</a></li><li class="nav-list-item"><a href="https://twitter.com/kangfenmao" target="_blank" class="nav-list-link"> Twitter</a></li><li class="nav-list-item"><a href="https://github.com/excitedcat" target="_blank" class="nav-list-link"> Github</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link"> RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">压力测试</h1><div class="post-info">2018-01-14</div><div class="post-content"><p>测试环境：克隆bothub-ai-prod环境<br>测试机器：同局域网内bothub-test-01机器<br>测试脚本：ab -n 1000 -c 30 <a href="http://10.140.0.15/test-successful-json-api" target="_blank" rel="noopener">http://10.140.0.15/test-successful-json-api</a>  </p>
<h1 id="未做任何优化"><a href="#未做任何优化" class="headerlink" title="未做任何优化"></a>未做任何优化</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">Server Software:        nginx/1.6.2</span><br><span class="line">Server Hostname:        10.140.0.15</span><br><span class="line">Server Port:            80</span><br><span class="line">Document Path:          /test-successful-json-api</span><br><span class="line">Document Length:        105 bytes</span><br><span class="line">Concurrency Level:      30</span><br><span class="line">Time taken for tests:   40.650 seconds</span><br><span class="line">Complete requests:      1000</span><br><span class="line">Failed requests:        0</span><br><span class="line">Total transferred:      340000 bytes</span><br><span class="line">HTML transferred:       105000 bytes</span><br><span class="line">Requests per second:    24.60 [#/sec] (mean)</span><br><span class="line">Time per request:       1219.503 [ms] (mean)</span><br><span class="line">Time per request:       40.650 [ms] (mean, across all concurrent requests)</span><br><span class="line">Transfer rate:          8.17 [Kbytes/sec] received</span><br><span class="line">Connection Times (ms)</span><br><span class="line">              min  mean[+/-sd] median   max</span><br><span class="line">Connect:        0    0   0.2      0       2</span><br><span class="line">Processing:   587 1212 130.4   1223    1550</span><br><span class="line">Waiting:      587 1212 130.4   1223    1550</span><br><span class="line">Total:        588 1212 130.4   1224    1550</span><br><span class="line">Percentage of the requests served within a certain time (ms)</span><br><span class="line"><span class="meta">  50%</span><span class="bash">   1224</span></span><br><span class="line"><span class="meta">  66%</span><span class="bash">   1272</span></span><br><span class="line"><span class="meta">  75%</span><span class="bash">   1304</span></span><br><span class="line"><span class="meta">  80%</span><span class="bash">   1322</span></span><br><span class="line"><span class="meta">  90%</span><span class="bash">   1368</span></span><br><span class="line"><span class="meta">  95%</span><span class="bash">   1408</span></span><br><span class="line"><span class="meta">  98%</span><span class="bash">   1442</span></span><br><span class="line"><span class="meta">  99%</span><span class="bash">   1475</span></span><br><span class="line"><span class="meta"> 100%</span><span class="bash">   1550 (longest request)</span></span><br></pre></td></tr></table></figure>
<p>单次请求时间：1219ms<br>每秒钟处理请求数：24.6  </p>
<h1 id="关闭debug模式"><a href="#关闭debug模式" class="headerlink" title="关闭debug模式"></a>关闭debug模式</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">Server Software:        nginx/1.6.2</span><br><span class="line">Server Hostname:        10.140.0.15</span><br><span class="line">Server Port:            80</span><br><span class="line">Document Path:          /test-successful-json-api</span><br><span class="line">Document Length:        105 bytes</span><br><span class="line">Concurrency Level:      30</span><br><span class="line">Time taken for tests:   35.839 seconds</span><br><span class="line">Complete requests:      1000</span><br><span class="line">Failed requests:        0</span><br><span class="line">Total transferred:      340000 bytes</span><br><span class="line">HTML transferred:       105000 bytes</span><br><span class="line">Requests per second:    27.90 [#/sec] (mean)</span><br><span class="line">Time per request:       1075.177 [ms] (mean)</span><br><span class="line">Time per request:       35.839 [ms] (mean, across all concurrent requests)</span><br><span class="line">Transfer rate:          9.26 [Kbytes/sec] received</span><br><span class="line">Connection Times (ms)</span><br><span class="line">              min  mean[+/-sd] median   max</span><br><span class="line">Connect:        0    0   0.2      0       2</span><br><span class="line">Processing:   591 1068 120.8   1051    1454</span><br><span class="line">Waiting:      591 1068 120.8   1051    1454</span><br><span class="line">Total:        592 1068 120.8   1051    1454</span><br><span class="line">Percentage of the requests served within a certain time (ms)</span><br><span class="line"><span class="meta">  50%</span><span class="bash">   1051</span></span><br><span class="line"><span class="meta">  66%</span><span class="bash">   1111</span></span><br><span class="line"><span class="meta">  75%</span><span class="bash">   1151</span></span><br><span class="line"><span class="meta">  80%</span><span class="bash">   1177</span></span><br><span class="line"><span class="meta">  90%</span><span class="bash">   1237</span></span><br><span class="line"><span class="meta">  95%</span><span class="bash">   1280</span></span><br><span class="line"><span class="meta">  98%</span><span class="bash">   1324</span></span><br><span class="line"><span class="meta">  99%</span><span class="bash">   1352</span></span><br><span class="line"><span class="meta"> 100%</span><span class="bash">   1454 (longest request)</span></span><br></pre></td></tr></table></figure>
<p>单次请求时间：1075ms<br>每秒钟处理请求数：27.9<br>性能提升：13%<br>时间节省：11.8%  </p>
<h1 id="开启config缓存"><a href="#开启config缓存" class="headerlink" title="开启config缓存"></a>开启config缓存</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">Server Software:        nginx/1.6.2</span><br><span class="line">Server Hostname:        10.140.0.15</span><br><span class="line">Server Port:            80</span><br><span class="line">Document Path:          /test-successful-json-api</span><br><span class="line">Document Length:        105 bytes</span><br><span class="line">Concurrency Level:      30</span><br><span class="line">Time taken for tests:   32.625 seconds</span><br><span class="line">Complete requests:      1000</span><br><span class="line">Failed requests:        0</span><br><span class="line">Total transferred:      340000 bytes</span><br><span class="line">HTML transferred:       105000 bytes</span><br><span class="line">Requests per second:    30.65 [#/sec] (mean)</span><br><span class="line">Time per request:       978.736 [ms] (mean)</span><br><span class="line">Time per request:       32.625 [ms] (mean, across all concurrent requests)</span><br><span class="line">Transfer rate:          10.18 [Kbytes/sec] received</span><br><span class="line">Connection Times (ms)</span><br><span class="line">              min  mean[+/-sd] median   max</span><br><span class="line">Connect:        0    0   0.4      0       8</span><br><span class="line">Processing:   528  975 107.2    955    1395</span><br><span class="line">Waiting:      528  975 107.2    955    1395</span><br><span class="line">Total:        528  975 107.2    956    1396</span><br><span class="line">Percentage of the requests served within a certain time (ms)</span><br><span class="line"><span class="meta">  50%</span><span class="bash">    956</span></span><br><span class="line"><span class="meta">  66%</span><span class="bash">    989</span></span><br><span class="line"><span class="meta">  75%</span><span class="bash">   1024</span></span><br><span class="line"><span class="meta">  80%</span><span class="bash">   1049</span></span><br><span class="line"><span class="meta">  90%</span><span class="bash">   1122</span></span><br><span class="line"><span class="meta">  95%</span><span class="bash">   1191</span></span><br><span class="line"><span class="meta">  98%</span><span class="bash">   1260</span></span><br><span class="line"><span class="meta">  99%</span><span class="bash">   1306</span></span><br><span class="line"><span class="meta"> 100%</span><span class="bash">   1396 (longest request)</span></span><br></pre></td></tr></table></figure>
<p>单次请求时间：978ms<br>每秒钟处理请求数：30.65<br>性能提升：9.9%<br>时间节省：9%  </p>
<h1 id="开启路由缓存"><a href="#开启路由缓存" class="headerlink" title="开启路由缓存"></a>开启路由缓存</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">Server Software:        nginx/1.6.2</span><br><span class="line">Server Hostname:        10.140.0.15</span><br><span class="line">Server Port:            80</span><br><span class="line">Document Path:          /test-successful-json-api</span><br><span class="line">Document Length:        105 bytes</span><br><span class="line">Concurrency Level:      30</span><br><span class="line">Time taken for tests:   21.354 seconds</span><br><span class="line">Complete requests:      1000</span><br><span class="line">Failed requests:        0</span><br><span class="line">Total transferred:      340000 bytes</span><br><span class="line">HTML transferred:       105000 bytes</span><br><span class="line">Requests per second:    46.83 [#/sec] (mean)</span><br><span class="line">Time per request:       640.630 [ms] (mean)</span><br><span class="line">Time per request:       21.354 [ms] (mean, across all concurrent requests)</span><br><span class="line">Transfer rate:          15.55 [Kbytes/sec] received</span><br><span class="line">Connection Times (ms)</span><br><span class="line">              min  mean[+/-sd] median   max</span><br><span class="line">Connect:        0    0   0.2      0       1</span><br><span class="line">Processing:   328  636  56.1    636     849</span><br><span class="line">Waiting:      328  636  56.1    636     849</span><br><span class="line">Total:        329  636  56.1    636     850</span><br><span class="line">Percentage of the requests served within a certain time (ms)</span><br><span class="line"><span class="meta">  50%</span><span class="bash">    636</span></span><br><span class="line"><span class="meta">  66%</span><span class="bash">    652</span></span><br><span class="line"><span class="meta">  75%</span><span class="bash">    663</span></span><br><span class="line"><span class="meta">  80%</span><span class="bash">    670</span></span><br><span class="line"><span class="meta">  90%</span><span class="bash">    693</span></span><br><span class="line"><span class="meta">  95%</span><span class="bash">    718</span></span><br><span class="line"><span class="meta">  98%</span><span class="bash">    754</span></span><br><span class="line"><span class="meta">  99%</span><span class="bash">    808</span></span><br><span class="line"><span class="meta"> 100%</span><span class="bash">    850 (longest request)</span></span><br></pre></td></tr></table></figure>
<p>单次请求时间：640ms<br>每秒钟处理请求数：46.83<br>性能提升：51.1%<br>时间节省：34.5%  </p>
<h1 id="optimimze"><a href="#optimimze" class="headerlink" title="optimimze"></a>optimimze</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">Server Software:        nginx/1.6.2</span><br><span class="line">Server Hostname:        10.140.0.15</span><br><span class="line">Server Port:            80</span><br><span class="line">Document Path:          /test-successful-json-api</span><br><span class="line">Document Length:        105 bytes</span><br><span class="line">Concurrency Level:      30</span><br><span class="line">Time taken for tests:   20.693 seconds</span><br><span class="line">Complete requests:      1000</span><br><span class="line">Failed requests:        0</span><br><span class="line">Total transferred:      340000 bytes</span><br><span class="line">HTML transferred:       105000 bytes</span><br><span class="line">Requests per second:    48.33 [#/sec] (mean)</span><br><span class="line">Time per request:       620.781 [ms] (mean)</span><br><span class="line">Time per request:       20.693 [ms] (mean, across all concurrent requests)</span><br><span class="line">Transfer rate:          16.05 [Kbytes/sec] received</span><br><span class="line">Connection Times (ms)</span><br><span class="line">              min  mean[+/-sd] median   max</span><br><span class="line">Connect:        0    0   0.2      0       3</span><br><span class="line">Processing:   297  617  56.7    617     928</span><br><span class="line">Waiting:      296  617  56.7    617     928</span><br><span class="line">Total:        297  617  56.7    617     928</span><br><span class="line">Percentage of the requests served within a certain time (ms)</span><br><span class="line"><span class="meta">  50%</span><span class="bash">    617</span></span><br><span class="line"><span class="meta">  66%</span><span class="bash">    633</span></span><br><span class="line"><span class="meta">  75%</span><span class="bash">    644</span></span><br><span class="line"><span class="meta">  80%</span><span class="bash">    651</span></span><br><span class="line"><span class="meta">  90%</span><span class="bash">    672</span></span><br><span class="line"><span class="meta">  95%</span><span class="bash">    698</span></span><br><span class="line"><span class="meta">  98%</span><span class="bash">    753</span></span><br><span class="line"><span class="meta">  99%</span><span class="bash">    777</span></span><br><span class="line"><span class="meta"> 100%</span><span class="bash">    928 (longest request)</span></span><br></pre></td></tr></table></figure>
<p>单次请求时间：620ms<br>每秒钟处理请求数：48<br>性能提升：2.5%<br>时间节省：3.1%  </p>
<h1 id="opcache"><a href="#opcache" class="headerlink" title="opcache"></a>opcache</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">opcache.enable=<span class="number">1</span></span><br><span class="line">opcache.memory_consumption=<span class="number">512</span></span><br><span class="line">opcache.interned_strings_buffer=<span class="number">64</span></span><br><span class="line">opcache.max_accelerated_files=<span class="number">20000</span></span><br><span class="line">opcache.validate_timestamps=<span class="number">0</span></span><br><span class="line">opcache.save_comments=<span class="number">1</span></span><br><span class="line">opcache.fast_shutdown=<span class="number">1</span></span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">Server Software:        nginx/1.6.2</span><br><span class="line">Server Hostname:        10.140.0.15</span><br><span class="line">Server Port:            80</span><br><span class="line">Document Path:          /test-successful-json-api</span><br><span class="line">Document Length:        105 bytes</span><br><span class="line">Concurrency Level:      30</span><br><span class="line">Time taken for tests:   19.691 seconds</span><br><span class="line">Complete requests:      1000</span><br><span class="line">Failed requests:        0</span><br><span class="line">Total transferred:      340000 bytes</span><br><span class="line">HTML transferred:       105000 bytes</span><br><span class="line">Requests per second:    50.78 [#/sec] (mean)</span><br><span class="line">Time per request:       590.735 [ms] (mean)</span><br><span class="line">Time per request:       19.691 [ms] (mean, across all concurrent requests)</span><br><span class="line">Transfer rate:          16.86 [Kbytes/sec] received</span><br><span class="line">Connection Times (ms)</span><br><span class="line">              min  mean[+/-sd] median   max</span><br><span class="line">Connect:        0    0   0.3      0       2</span><br><span class="line">Processing:   351  587  74.0    588    1092</span><br><span class="line">Waiting:      351  587  74.0    588    1092</span><br><span class="line">Total:        352  587  74.0    588    1092</span><br><span class="line">Percentage of the requests served within a certain time (ms)</span><br><span class="line"><span class="meta">  50%</span><span class="bash">    588</span></span><br><span class="line"><span class="meta">  66%</span><span class="bash">    616</span></span><br><span class="line"><span class="meta">  75%</span><span class="bash">    629</span></span><br><span class="line"><span class="meta">  80%</span><span class="bash">    640</span></span><br><span class="line"><span class="meta">  90%</span><span class="bash">    680</span></span><br><span class="line"><span class="meta">  95%</span><span class="bash">    715</span></span><br><span class="line"><span class="meta">  98%</span><span class="bash">    743</span></span><br><span class="line"><span class="meta">  99%</span><span class="bash">    768</span></span><br><span class="line"><span class="meta"> 100%</span><span class="bash">   1092 (longest request)</span></span><br></pre></td></tr></table></figure>
<p>单次请求时间：590ms<br>每秒钟处理请求数：50.7<br>性能提升：4.2%<br>时间节省：4.8%  </p>
<h1 id="卸载newrelic"><a href="#卸载newrelic" class="headerlink" title="卸载newrelic"></a>卸载newrelic</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">Server Software:        nginx/1.6.2</span><br><span class="line">Server Hostname:        10.140.0.15</span><br><span class="line">Server Port:            80</span><br><span class="line">Document Path:          /test-successful-json-api</span><br><span class="line">Document Length:        105 bytes</span><br><span class="line">Concurrency Level:      30</span><br><span class="line">Time taken for tests:   18.104 seconds</span><br><span class="line">Complete requests:      1000</span><br><span class="line">Failed requests:        0</span><br><span class="line">Total transferred:      340000 bytes</span><br><span class="line">HTML transferred:       105000 bytes</span><br><span class="line">Requests per second:    55.24 [#/sec] (mean)</span><br><span class="line">Time per request:       543.121 [ms] (mean)</span><br><span class="line">Time per request:       18.104 [ms] (mean, across all concurrent requests)</span><br><span class="line">Transfer rate:          18.34 [Kbytes/sec] received</span><br><span class="line">Connection Times (ms)</span><br><span class="line">              min  mean[+/-sd] median   max</span><br><span class="line">Connect:        0    0   0.2      0       2</span><br><span class="line">Processing:   241  540  95.9    524     836</span><br><span class="line">Waiting:      241  540  95.9    524     836</span><br><span class="line">Total:        241  541  95.9    524     836</span><br><span class="line">Percentage of the requests served within a certain time (ms)</span><br><span class="line"><span class="meta">  50%</span><span class="bash">    524</span></span><br><span class="line"><span class="meta">  66%</span><span class="bash">    554</span></span><br><span class="line"><span class="meta">  75%</span><span class="bash">    587</span></span><br><span class="line"><span class="meta">  80%</span><span class="bash">    618</span></span><br><span class="line"><span class="meta">  90%</span><span class="bash">    688</span></span><br><span class="line"><span class="meta">  95%</span><span class="bash">    732</span></span><br><span class="line"><span class="meta">  98%</span><span class="bash">    768</span></span><br><span class="line"><span class="meta">  99%</span><span class="bash">    796</span></span><br><span class="line"><span class="meta"> 100%</span><span class="bash">    836 (longest request)</span></span><br></pre></td></tr></table></figure>
<p>单次请求时间：543ms<br>每秒钟处理请求数：55.2<br>性能提升：8.7%<br>时间节省：8%  </p>
<h1 id="php7-1"><a href="#php7-1" class="headerlink" title="php7.1"></a>php7.1</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">Server Software:        nginx/1.6.2</span><br><span class="line">Server Hostname:        10.140.0.15</span><br><span class="line">Server Port:            80</span><br><span class="line">Document Path:          /test-successful-json-api</span><br><span class="line">Document Length:        105 bytes</span><br><span class="line">Concurrency Level:      30</span><br><span class="line">Time taken for tests:   6.604 seconds</span><br><span class="line">Complete requests:      1000</span><br><span class="line">Failed requests:        0</span><br><span class="line">Total transferred:      305000 bytes</span><br><span class="line">HTML transferred:       105000 bytes</span><br><span class="line">Requests per second:    151.43 [#/sec] (mean)</span><br><span class="line">Time per request:       198.107 [ms] (mean)</span><br><span class="line">Time per request:       6.604 [ms] (mean, across all concurrent requests)</span><br><span class="line">Transfer rate:          45.10 [Kbytes/sec] received</span><br><span class="line">Connection Times (ms)</span><br><span class="line">              min  mean[+/-sd] median   max</span><br><span class="line">Connect:        0    0   0.1      0       1</span><br><span class="line">Processing:    30  197  67.2    189     534</span><br><span class="line">Waiting:       30  197  67.2    189     534</span><br><span class="line">Total:         30  197  67.2    189     535</span><br><span class="line">Percentage of the requests served within a certain time (ms)</span><br><span class="line"><span class="meta">  50%</span><span class="bash">    189</span></span><br><span class="line"><span class="meta">  66%</span><span class="bash">    216</span></span><br><span class="line"><span class="meta">  75%</span><span class="bash">    234</span></span><br><span class="line"><span class="meta">  80%</span><span class="bash">    249</span></span><br><span class="line"><span class="meta">  90%</span><span class="bash">    284</span></span><br><span class="line"><span class="meta">  95%</span><span class="bash">    324</span></span><br><span class="line"><span class="meta">  98%</span><span class="bash">    372</span></span><br><span class="line"><span class="meta">  99%</span><span class="bash">    400</span></span><br><span class="line"><span class="meta"> 100%</span><span class="bash">    535 (longest request)</span></span><br></pre></td></tr></table></figure>
<p>单次请求时间：198ms<br>每秒钟处理请求数：151<br>性能提升：将近3倍<br>时间节省：64%  </p>
<h1 id="laravel5-2-new-php5-6"><a href="#laravel5-2-new-php5-6" class="headerlink" title="laravel5.2 new (php5.6)"></a>laravel5.2 new (php5.6)</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">Server Software:        nginx/1.6.2</span><br><span class="line">Server Hostname:        10.140.0.15</span><br><span class="line">Server Port:            80</span><br><span class="line">Document Path:          /</span><br><span class="line">Document Length:        1035 bytes</span><br><span class="line">Concurrency Level:      30</span><br><span class="line">Time taken for tests:   10.664 seconds</span><br><span class="line">Complete requests:      1000</span><br><span class="line">Failed requests:        0</span><br><span class="line">Total transferred:      2023352 bytes</span><br><span class="line">HTML transferred:       1035000 bytes</span><br><span class="line">Requests per second:    93.78 [#/sec] (mean)</span><br><span class="line">Time per request:       319.910 [ms] (mean)</span><br><span class="line">Time per request:       10.664 [ms] (mean, across all concurrent requests)</span><br><span class="line">Transfer rate:          185.30 [Kbytes/sec] received</span><br><span class="line">Connection Times (ms)</span><br><span class="line">              min  mean[+/-sd] median   max</span><br><span class="line">Connect:        0    0   0.2      0       2</span><br><span class="line">Processing:    28  313 223.8    287    1847</span><br><span class="line">Waiting:       28  313 223.6    287    1847</span><br><span class="line">Total:         28  314 223.8    288    1847</span><br><span class="line">Percentage of the requests served within a certain time (ms)</span><br><span class="line"><span class="meta">  50%</span><span class="bash">    288</span></span><br><span class="line"><span class="meta">  66%</span><span class="bash">    316</span></span><br><span class="line"><span class="meta">  75%</span><span class="bash">    338</span></span><br><span class="line"><span class="meta">  80%</span><span class="bash">    355</span></span><br><span class="line"><span class="meta">  90%</span><span class="bash">    409</span></span><br><span class="line"><span class="meta">  95%</span><span class="bash">    460</span></span><br><span class="line"><span class="meta">  98%</span><span class="bash">   1413</span></span><br><span class="line"><span class="meta">  99%</span><span class="bash">   1699</span></span><br><span class="line"><span class="meta"> 100%</span><span class="bash">   1847 (longest request)</span></span><br></pre></td></tr></table></figure>
<p>单次请求时间：319ms<br>每秒钟处理请求数：93  </p>
<h1 id="laravel5-2-new-php7-1"><a href="#laravel5-2-new-php7-1" class="headerlink" title="laravel5.2 new (php7.1)"></a>laravel5.2 new (php7.1)</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">Server Software:        nginx/1.6.2</span><br><span class="line">Server Hostname:        10.140.0.15</span><br><span class="line">Server Port:            80</span><br><span class="line">Document Path:          /</span><br><span class="line">Document Length:        1035 bytes</span><br><span class="line">Concurrency Level:      30</span><br><span class="line">Time taken for tests:   6.350 seconds</span><br><span class="line">Complete requests:      1000</span><br><span class="line">Failed requests:        0</span><br><span class="line">Total transferred:      1988164 bytes</span><br><span class="line">HTML transferred:       1035000 bytes</span><br><span class="line">Requests per second:    157.47 [#/sec] (mean)</span><br><span class="line">Time per request:       190.508 [ms] (mean)</span><br><span class="line">Time per request:       6.350 [ms] (mean, across all concurrent requests)</span><br><span class="line">Transfer rate:          305.75 [Kbytes/sec] received</span><br><span class="line">Connection Times (ms)</span><br><span class="line">              min  mean[+/-sd] median   max</span><br><span class="line">Connect:        0    0   0.2      0       1</span><br><span class="line">Processing:     4  173 527.1     99    5778</span><br><span class="line">Waiting:        4  172 527.1     99    5778</span><br><span class="line">Total:          4  173 527.1     99    5779</span><br><span class="line">Percentage of the requests served within a certain time (ms)</span><br><span class="line"><span class="meta">  50%</span><span class="bash">     99</span></span><br><span class="line"><span class="meta">  66%</span><span class="bash">    131</span></span><br><span class="line"><span class="meta">  75%</span><span class="bash">    148</span></span><br><span class="line"><span class="meta">  80%</span><span class="bash">    165</span></span><br><span class="line"><span class="meta">  90%</span><span class="bash">    225</span></span><br><span class="line"><span class="meta">  95%</span><span class="bash">    283</span></span><br><span class="line"><span class="meta">  98%</span><span class="bash">    327</span></span><br><span class="line"><span class="meta">  99%</span><span class="bash">   4139</span></span><br><span class="line"><span class="meta"> 100%</span><span class="bash">   5779 (longest request)</span></span><br></pre></td></tr></table></figure>
<p>单次请求时间：190ms<br>每秒钟处理请求数：157  </p>
<p>总结：开启配置及路由缓存，更换php7可大幅提高性能（性能提升6.1倍，请求时间节省84%）</p>
</div></article></div></main><footer><div class="paginator"><a href="/2018/01/14/hello-world/" class="next">NEXT</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'excitedcat';
var disqus_identifier = '2018/01/14/rapture-api压力测试/';
var disqus_title = '压力测试';
var disqus_url = 'http://www.ijustplay.cn/2018/01/14/rapture-api压力测试/';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//excitedcat.disqus.com/count.js" async></script><div class="copyright"><p>© 2015 - 2018 <a href="http://www.ijustplay.cn">kangfenmao</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>